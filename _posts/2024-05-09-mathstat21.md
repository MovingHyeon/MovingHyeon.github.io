---
title: Medians as an Estimator(중앙값의 추정량으로써의 역할)
date: 2024-04-27 00:54:00 +09:00
categories: [Statistics, Mathematical Statistics]
math: true
pin: true
tags:
  [
    probability,
    mathematical statistics,
    median,
    percentile,
    estimator,
    large sample theory
  ]
---

지난 글에서는 likelihood에 입각하여 설정한 MLE에 대해서 간단히 다루었다. 그럴듯하게 정의된 MLE에 이어서, 이번에는 median<sub>중앙값</sub>이 estimator로 활용되었을 때 역시 성능 좋은 estimator로 활용될 수 있을지 정량적으로 알아보고자 한다. CLT 등에서 보면 우리는 늘 sample mean에 상당한 관심을 가지고 효율성과 limiting distribution 등 많은 것을 분석하였다. 우리는 data의 outlier<sub>이상치</sub>에 취약하다는 mean이 가지는 단점을 median이 보완할 수 있다는 점을 뻔히 알면서도 median을 estimator로써 활용할 생각을 지금까지 미처 하지 못했던 것이다. 이번 글에서는 그러므로 median을 estimator로 활용할 때 가져오는 장점 등을 파악할 것이다. 그리고 생각보다 median은 mean 못지 않게 실제로 상당히 많이 활용되는데, Bayesain inference에서는 심지어 이 둘의 성능 차이가 거의 없다고 판단하고 median이 더 계산이 편리하다는 이유로 posterior median<sub>사후 중앙값</sub> 등을 estimator로 mean보다도 더 많이 활용한다. 즉, median도 결코 무시해서는 안 될 estimator라는 것이다.

<br>
<br>

-1Median을 order statistic을 활용하여 수학적으로 표현해보자. Random sample $X\_1, X\_2, \cdots, X\_n$에 대하여 median $\tilde{X}$는

$$ \tilde{X} = \begin{cases}
X_{(m)}, & n = 2m-1; \\
\frac{1}{2}(X_{(m)}+X_{(m+1)}), & n = 2m.
\end{cases}
$$

로 나타낼 수 있다. 이제 random sample $X\_1, X\_2, \cdots$가 i.i.d.이고 동일한 CDF $F$를 가지고 있다고 하자. 그리고 $\tilde{X}\_n$을 첫 $n$ 개의 sample의 median이라고 두자. 적당한 regularity condition 아래에서 $F$는 unique한 median $\theta$, 즉 $F(\theta) = 1/2$인 $\theta$가 unique하게 존재한다고 하고, 그 $\theta$에 대하여 $F'(\theta)$도 존재한다고 하자. 우리는 이제 다음을 근사하고자 할 것이다.

$$ P(\sqrt{n}(\tilde{X}_n - \theta)\le a) = P(\tilde{X}_n\le \theta +a/\sqrt{n})$$

다음을 정의하자.

$$ S_n = \#\{i\le n: X_i\le \theta+a/\sqrt{n}\}$$

그러면 우리는 다음 두 event가 동일함을 알 수 있다.

$$ \tilde{X}_n\le \theta +a/\sqrt{n} \Longleftrightarrow S_n\ge m$$

또한, 각 $i$에 대하여 $X\_i \le \theta+a/\sqrt{n}$이 성립하면 성공했다는 관점에서 보면, 우리는 

$$S_n\sim B(n, F(\theta+a/\sqrt{n}))$$

임을 알 수 있다. 이제 binomial distribution에 대한 normal distribution 근사를 다음을 근거로 하여 시도할 것이다. 이는 CLT로부터 바로 유도된다.

$$
\begin{align*}
\sqrt{n}\left(\frac{Y_n}{n} - p\right) &= \frac{Y_n - np}{\sqrt{n}}\leadsto N(0, p(1-p)) \\
P\left(\frac{Y_n - np}{\sqrt{n}}\gt y\right) &= 1 - P\left(\frac{Y_n - np}{\sqrt{n}}\le y\right) \\
&\to 1 - \Phi\left(\frac{y}{\sqrt{p(1-p)}}\right) = \Phi\left(\frac{-y}{\sqrt{p(1-p)}}), \quad n\to\infty
\end{align*}
$$

이를 활용하면

$$
\begin{align*}
P(\sqrt{n}(\tilde{X}_n - \theta)\le a) & = P(S_n \gt m - 1) \\
&= P\left(\frac{S_n - nF(\theta+a/\sqrt{n})}{\sqrt{n}}\gt\frac{m-1-nF(\theta+a/\sqrt{n})}{\sqrt{n}}\right) \\
&= \Phi\left(\frac{[nF(\theta+a/\sqrt{n})-m+1]/\sqrt{n}}{\sqrt{F(\theta+a/\sqrt{n})(1 - F(\theta+a/\sqrt{n}))}}\right) + o(1) 
\end{align*}
$$

이때 $o(1)$은 $n\to\infty$임에 따라 0으로 converge하는 모든 sequence를 통들어 일컫는 표기방식이다. 이에 대해선 곧 따라오는 글에서 다루게 될 것이다. 무튼, $F$가 $\theta$에서 continuous하기 떄문에

$$\sqrt{F(\theta+a/\sqrt{n})(1 - F(\theta+a/\sqrt{n}))} \to 1/2, \quad n\to\infty $$

이다. 또 $F$는 $\theta$에서 differentiable하기 때문에

$$
\begin{align*}
\frac{nF(\theta+a/\sqrt{n})-m+1}{\sqrt{n}} &= a\frac{F(\theta+a/\sqrt{n}) - F(\theta)}{\sqrt{n}} + \frac{nF(\theta)-m+1}{\sqrt{n}} \\
&= a\frac{F(\theta+a/\sqrt{n}) - F(\theta)}{a/\sqrt{n}} +\frac{1}{2\sqrt{n}} \\
&\to a F'(\theta), \quad n\to\infty 
\end{align*}
$$

이다. 따라서 우리는

$$P(\sqrt{n}(\tilde{X}_n - \theta)\le a)\to \Phi(2aF'(\theta))$$

를 얻고, 이를 다시 표현하면

$$\sqrt{n}(\tilde{X}_n - \theta)\leadsto N\left(0, \frac{1}{4[F'(\theta)]^2}\right)$$

가 된다. 우리는 따라서 median의 limiting distribution을 유도하였다.

비슷한 과정으로 우리는 median뿐만 아니라 다른 quantile<sub>분위수</sub>에 대하여도 얼마든지 limiting distribution을 비슷한 방식으로 유도할 수 있다.

<br>

> **Theorem 21.1** $X\_1, X\_2, \cdots$가 i.i.d. random sample이고 동일한 CDF $F$로부터 추출되었다고 하자. $\gamma\in(0, 1)$에 대하여 $\tilde{\theta}\_n$을 첫 $n$개의 sample $X\_1, \cdots, X\_n$에 대하여 $\lceil\gamma n\rceil$th order statistic이라고 두자(혹은 $\lceil\gamma n\rceil$과 $\lfloor\gamma n\rfloor$th order statistic의 weighted sum<sub>가중합</sub>). $F(\theta) = \gamma$인 $\theta$에 대하여 $F'(\theta)$가 존재하고 finite하며 positive할 때, $n\to\infty$임에 따라
>
> $\sqrt{n}(\tilde{\theta}_n - \theta) \leadsto N\left(0, \frac{\gamma(1-\gamma)}{[F'(\theta)]^2})$$
>
> 가 성립한다.